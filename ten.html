<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>Ten - buffer geometry</title>
	<style>
		#threejsContainer {
			width: 400px;
			height: 400px;
			border: thin red solid;
			/* so we can see it */
		}
	</style>
	<script src="js/three.js"></script>
	<script>
		var scene
		var camera
		var renderer
		var plane;

		function init() {
			// setup
			renderer = new THREE.WebGLRenderer();
			// get container div
			var container = document.getElementById("threejsContainer");
			// add renderer DOM element to it
			container.appendChild(renderer.domElement);
			var width = window.getComputedStyle(container).width;
			var height = window.getComputedStyle(container).height;
			width = parseInt(width);
			height = parseInt(height);
			renderer.setSize(width, height);

			scene = new THREE.Scene();
			camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);

			camera.up = new THREE.Vector3(0, 0, 1);
			camera.position.set(10, 10, 5);
			camera.lookAt(0, 0, 0);

			// add lighting
			const ambient = new THREE.AmbientLight(0x808080); // soft white light
			scene.add(ambient);
			// blue directional light at medium intensity shining from y.
			const directionalLight = new THREE.DirectionalLight(0x0000ff, 0.7);
			scene.add(directionalLight);

			// draw 3 axes
			// x is blue
			var material = new THREE.LineBasicMaterial({
				color: 0x0000ff
			});
			var points = [];
			points.push(new THREE.Vector3(0, 0, 0));
			points.push(new THREE.Vector3(10, 0, 0));
			var geometry = new THREE.BufferGeometry().setFromPoints(points);
			var line = new THREE.Line(geometry, material);
			scene.add(line);
			// y is green
			material = new THREE.LineBasicMaterial({
				color: 0x00ff00
			});
			points = [];
			points.push(new THREE.Vector3(0, 0, 0));
			points.push(new THREE.Vector3(0, 10, 0));
			geometry = new THREE.BufferGeometry().setFromPoints(points);
			line = new THREE.Line(geometry, material);
			scene.add(line);

			for (var x = -10; x < 10; x++)
				for (var y = -10; y < 10; y++) {
					geometry = new THREE.PlaneGeometry(1, 1);
					geometry.translate(0.5, 0.5, 0)
					geometry.translate(x, y, 0)
					material = new THREE.MeshPhongMaterial();
					material.side = THREE.DoubleSide;
					if ((x + y) % 2 == 0)
						material.color = new THREE.Color((y + 10) / 20, 0, (x + 10) / 20);

					plane = new THREE.Mesh(geometry, material);
					scene.add(plane);
				}

			geometry = new THREE.BufferGeometry();

			vertices = new Float32Array([
				0, 0, 3,
				0, 0, 6,
				5, 0, 6,
				5, 0, 6,
				5, 0, 10,
				10, 0, 10

			]);

			geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3));
			material = new THREE.MeshBasicMaterial({
				color: 0xff0000
			}); // single-sided
			const mesh = new THREE.Mesh(geometry, material);
			scene.add(mesh);

			render();
		}

		function render() {
			renderer.render(scene, camera);
			// get length of projection of camera vector on x y plane
			var r = Math.sqrt(camera.position.x * camera.position.x + camera.position.y * camera.position.y);
			// get angle of that
			var angle = Math.atan2(camera.position.y, camera.position.x);
			// change x and y components
			camera.position.x = r * Math.cos(angle + 0.005);
			camera.position.y = r * Math.sin(angle + 0.005);
			camera.lookAt(0, 0, 0);
			requestAnimationFrame(render);
		}
	</script>

</head>

<body onload="init()">
	<div>A header</div>
	<div id="threejsContainer"></div>
	<!--will be inside this-->
	<div>More stuff</div>
</body>

</html>